# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy PostgreSQL
on:
  push:
    branches:
      - main 

permissions:
  checks: write
  contents: read
  pull-requests: write

jobs:
  setup:
    runs-on: potus
    steps:
      - uses: actions/checkout@v4

  
  deploy-server:
      runs-on: potus
      needs: setup
      steps:
        - uses: actions/checkout@v4
        - name: Quien soy
          run: whoami
        - name: Bajar servicio anterior Intento 1
          run: docker-compose -f docker-compose-potus.yml -p g4-db down
        - name: Bajar servicio anterior Intento 2
          run: docker-compose -f docker-compose-potus.yml -p g4-db down
        - name: Desplegar en LWS
          env:
            POSTGRES_USER: ${{ secrets.POSTGRES_USER}}
            POSTGRES_PASSWORD: ${{ secrets.POSTGRES_PASSWORD }}
            POSTGRES_DB: ${{ secrets.POSTGRES_DB }}
            PGADMIN_DEFAULT_EMAIL: ${{ secrets.PGADMIN_DEFAULT_EMAIL }}
            PGADMIN_DEFAULT_PASSWORD: ${{ secrets.PGADMIN_DEFAULT_PASSWORD }}
          run: docker-compose -f docker-compose-potus.yml -p g4-db up -d
